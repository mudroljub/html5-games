<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Proba</title>
	<script src="js/alatke.js"></script>
</head>
<body>

<script>

var slike = {
    pozadina: 'slike/skupstina2.png',
    naziv_grupe: {      // nazivi bitni, od njih pravi objekte!
        vulin: 'slike/vulin.png',
        toma: 'slike/toma.png',
        dacic: 'slike/dacic.png'
    },
    predmeti: {
        paradajz: "slike/politicar.png",
        jaje: "slike/politicar.png",
        krpa: "slike/politicar.png"
    }
}


// pozadinu ucitati zasebno !

var ucitajSlike = function(slike, povratnaRadnja){   // povratno pušta uvod
    var nazivi_grupa = Object.keys(slike);
	var broj_grupa = Object.keys(slike).length;
	var sve_slike = 0
    var ucitaneSlike = 0;

	// ucitati pozadinu
	// povecati sve_slike++
	// i povratno ucitaneSlike++

	for(var i=1; i < broj_grupa; i++) { 
		var naziv_grupe = nazivi_grupa[i];
		var likovi = slike[naziv_grupe];
		var imena_likova = Object.keys(likovi);
		var broj_likova = Object.keys(likovi).length;
		sve_slike = sve_slike + broj_likova
		
		for(var ime_lika in likovi){
			var ova_slika = new Image()
			ova_slika.onload = function kadUcitaSliku (){
				ucitaneSlike++;
				
				// promeniti slike da broj bude jednak ukupnom broju likova
				if(ucitaneSlike >= sve_slike) {
					kazi("ucitaneSlike: "+ucitaneSlike)
					povratnaRadnja();
				}
				
			} // kraj kadUcitaSliku
			var izvor_slike = likovi[ime_lika]
			ova_slika.src = izvor_slike			
		} // kraj for in petlje
	}	// kraj for < broj_grupa petlje

}	// kraj ucitajSlike


function _ucitajPozadinu(izvor_pozadine, povratnaRadnja){
	sve_slike++;
	var pozadina = new Image();
	pozadina.onload = function kadUcita() {
		ucitaneSlike++;
		povratnaRadnja();
	};
	pozadina.src = izvor_pozadine;		
}


function jelSveUcitano(povratnaRadnja){	// povratno da pusti uvod
	if(ucitaneSlike >= sve_slike) {
		povratnaRadnja();
	}	
}	// kraj jelSveUcitano


ucitajSlike(slike, function(){kazi("Sve učitano.")});


</script>

</body>
</html>
